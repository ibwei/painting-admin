{"version":3,"sources":["webpack:///./src/views/danger/message/index.tsx"],"names":["Message","filterParams","name","address","createtime","startTime","endTime","BackParams","code","codeOK","message","data","total","outParams","filterList","key","label","type","placeholder","value","tableList","title","dataIndex","width","customRender","typeRender","opreat","rowKey","color","val","status","text","roles","visible","modelType","editData","openType","popoverVisible","deviceName","url","others","render","h","this","$createElement","info","content","onOk","row","JSON","parse","stringify","window","api","deviceBaseInfoDelete","id","then","res","err_code","$message","success","error","position","Table","$refs","baseInfoTable","reloadTable","x","tableClick","add","closeModal","components"],"mappings":"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","file":"js/chunk-2d0a4b7c.bf92b5fa.js","sourcesContent":["import { Component, Vue } from 'vue-property-decorator';\r\nimport { Tag, Popover, Button, Modal } from 'ant-design-vue';\r\nimport { tableList, FilterFormList, Opreat } from '@/interface';\r\nimport InfoModal from './infoModal';\r\n\r\nimport './index.less';\r\n\r\n@Component({\r\n  name: 'message',\r\n  components: {\r\n    'a-tag': Tag,\r\n    'info-modal': InfoModal,\r\n    'a-popover': Popover,\r\n    'a-button': Button,\r\n  },\r\n})\r\nexport default class Message extends Vue {\r\n  filterParams: any = {\r\n    name: '',\r\n    address: [],\r\n    createtime: [],\r\n    startTime: '',\r\n    endTime: '',\r\n  };\r\n\r\n  BackParams: any = {\r\n    code: 'data.result.resultCode',\r\n    codeOK: 0,\r\n    message: 'data.result.resultMessage',\r\n    data: 'data.entity.data',\r\n    total: 'data.entity.total',\r\n  };\r\n\r\n  outParams: any = {};\r\n\r\n  filterList: FilterFormList[] = [\r\n    {\r\n      key: 'name',\r\n      label: 'name',\r\n      type: 'input',\r\n      placeholder: '请输入隐患名',\r\n    },\r\n    {\r\n      key: 'createtime',\r\n      label: 'Createtime',\r\n      type: 'datetimerange',\r\n      placeholder: ['开始时间', '结束时间'],\r\n      value: ['startTime', 'endTime'],\r\n    },\r\n  ];\r\n\r\n  tableList: tableList[] = [\r\n    {\r\n      title: '隐患名',\r\n      dataIndex: 'name',\r\n    },\r\n    {\r\n      title: '隐患内容',\r\n      dataIndex: 'detail',\r\n      width: '300px',\r\n    },\r\n    {\r\n      title: '上报时间',\r\n      dataIndex: 'createTime',\r\n    },\r\n    {\r\n      title: '审核状态',\r\n      dataIndex: 'status',\r\n      customRender: this.typeRender,\r\n    },\r\n  ];\r\n\r\n  opreat: Opreat[] = [\r\n    {\r\n      key: 'edit',\r\n      rowKey: 'id',\r\n      color: (val: any) => {\r\n        if (val.status === 0) {\r\n          return 'blue';\r\n        }\r\n        if (val.status === 1) {\r\n          return 'gray';\r\n        }\r\n        return 'green';\r\n      },\r\n      text: (val: any) => {\r\n        if (val.status === 0) {\r\n          return '去处理';\r\n        }\r\n        if (val.status === 1) {\r\n          return '查看详情'\r\n        }\r\n        return '查看结果';\r\n      },\r\n      roles: true,\r\n    },\r\n  ];\r\n\r\n  title: string = '新增隐患';\r\n\r\n  visible: boolean = false;\r\n\r\n  modelType: string = 'add';\r\n\r\n  editData: object = {};\r\n\r\n  openType: string = '';\r\n\r\n  imageRender(url: string) {\r\n    return <img src={url}></img>;\r\n  }\r\n\r\n  typeRender(type: number, others: any) {\r\n    const colorArray: Array<string> = ['pink', 'red', 'orange', 'green', 'cyan', 'blue', 'purple'];\r\n    let render: any = null;\r\n    if (type === 0) {\r\n      render = <a-tag color=\"red\">未提交处理</a-tag>;\r\n    } else if (type === 1) {\r\n      render = <a-tag color=\"blue\">审核中</a-tag>;\r\n    } else {\r\n      render = <a-tag color=\"green\">审核完成</a-tag>;\r\n    }\r\n    return render;\r\n  }\r\n\r\n  showSuccesResult(data: any) {\r\n    const h = this.$createElement;\r\n    Modal.info({\r\n      title: '处理隐患',\r\n      content: h('div', {}, [\r\n        h('p', 'some messages...some messages...'),\r\n      ]),\r\n      onOk() { },\r\n    });\r\n  }\r\n\r\n  tableClick(key: string, row: any) {\r\n    const data = JSON.parse(JSON.stringify(row));\r\n    switch (key) {\r\n      case 'edit':\r\n        if (row.status === 1) {\r\n          this.openType = 'read';\r\n          this.title = '隐患详情'\r\n        }\r\n        if (row.status === 0) {\r\n          this.openType = 'edit';\r\n          this.title = '处理隐患';\r\n        }\r\n        if (row.status === 2) {\r\n          this.openType = 'read';\r\n          this.title = '查看处理结果'\r\n        }\r\n        this.editData = data;\r\n        this.visible = true;\r\n        this.modelType = 'edit';\r\n        break;\r\n      case 'delete':\r\n        window.api.deviceBaseInfoDelete({ id: row.id }).then((res: any) => {\r\n          const { err_code } = res.data;\r\n          if (err_code === 0) {\r\n            this.$message.success('删除成功');\r\n            this.success();\r\n          } else {\r\n            this.$message.error('删除失败');\r\n          }\r\n        });\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  add() {\r\n    this.title = '添加隐患';\r\n    this.modelType = 'add';\r\n    this.visible = true;\r\n    this.editData = {};\r\n  }\r\n\r\n  closeModal() {\r\n    this.visible = false;\r\n    this.editData = {};\r\n  }\r\n\r\n  popoverVisible: boolean = false;\r\n\r\n  hideMapModal() {\r\n    this.popoverVisible = false;\r\n  }\r\n\r\n  position: any;\r\n\r\n  deviceName: string = '隐患';\r\n\r\n  showMapModal(others: any) {\r\n    this.position = others.position;\r\n    this.deviceName = others.name;\r\n    this.popoverVisible = true;\r\n  }\r\n\r\n  success() {\r\n    this.visible = false;\r\n    const Table: any = this.$refs.baseInfoTable;\r\n    this.editData = {};\r\n    Table.reloadTable();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"baseInfo-wrap\">\r\n        <filter-table\r\n          ref=\"baseInfoTable\"\r\n          tableList={this.tableList}\r\n          filterList={this.filterList}\r\n          filterGrade={[]}\r\n          scroll={{ x: 900 }}\r\n          url={'/dangerMessage/list'}\r\n          filterParams={this.filterParams}\r\n          outParams={this.outParams}\r\n          addBtn={false}\r\n          exportBtn={false}\r\n          dataType={'json'}\r\n          rowKey={'id'}\r\n          opreat={this.opreat}\r\n          fetchType={'post'}\r\n          backParams={this.BackParams}\r\n          on-menuClick={this.tableClick}\r\n          on-add={this.add}\r\n        />\r\n        {this.visible ? (\r\n          <info-modal\r\n            title={this.title}\r\n            position={this.position}\r\n            visible={this.visible}\r\n            type={this.modelType}\r\n            openType={this.openType}\r\n            data={this.editData}\r\n            on-close={this.closeModal}\r\n            on-success={this.success}\r\n          />\r\n        ) : (\r\n            ''\r\n          )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}