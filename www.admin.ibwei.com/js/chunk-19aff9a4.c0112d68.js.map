{"version":3,"sources":["webpack:///./src/views/login/index.tsx"],"names":["Login","loginForm","username","password","config","imgToken","loading","this","Form","validateFields","err","values","window","api","login","then","res","data","resultCode","resultMessage","$message","error","success","localStorage","setItem","token","setTimeout","$store","dispatch","$router","push","catch","errs","message","getFieldDecorator","name","submitForm","rules","required","components","Item","props","create"],"mappings":"o/BAkBA,IAAMA,EAAN,YAZA,iD,+DAaE,EAAAC,UAGI,CAAEC,SAAU,QAASC,SAAU,SAEnC,EAAAC,OAAS,OAET,EAAAC,SAAW,GAEX,EAAAC,SAAU,EAtBZ,EAYA,mHAeY,WACRC,KAAKC,KAAKC,gBAAe,SAACC,EAAUC,GAClC,OAAKD,IACH,EAAKJ,SAAU,EACfM,OAAOC,IACJC,MADH,KACcH,IACXI,MAAK,SAAAC,GACJ,EAAKV,SAAU,EADL,MAEkCU,EAAIC,KAAxCC,EAFE,EAEFA,WAAYC,EAFV,EAEUA,cAAeF,EAFzB,EAEyBA,KAChB,IAAfC,EACF,EAAKE,SAASC,MAAMF,GAAiB,SAErC,EAAKC,SAASE,QAAQH,GAEtBI,aAAaC,QAAQ,QAASP,EAAKQ,OACnCC,YAAW,WACT,EAAKC,OACFC,SAAS,eACTb,MAAK,WACJ,EAAKc,QAAQC,KAAK,QAEnBC,OAAM,SAAAV,GACL,EAAKD,SAASC,MAAMA,QAEvB,SAGNU,OAAM,SAACC,GACN,EAAK1B,SAAU,EACf,EAAKc,SAASC,MAAMW,EAAKC,aAEtB,QA9Cf,+BAoDQ,mBACIC,EAAsB3B,KAAKC,KAA3B0B,kBACR,sBACa,aADb,eAEc,YAFd,4CAOe,aAPf,gBAQiB,QARjB,WAUe,OAAOC,SAVtB,gBAYkB,YAZlB,WAYyC5B,KAAK6B,aAZ9C,kBAcWF,EAAkB,WAAY,CAC7BG,MAAO,CAAC,CAAEC,UAAU,EAAML,QAAS,aADpCC,CAAA,uBAGa,WAHb,cAGoC,gBAHpC,YAGgE,YAHhE,kBAIgB,SAJhB,YAI8B,eAlBzC,iBAuBWA,EAAkB,WAAY,CAC7BG,MAAO,CAAC,CAAEC,UAAU,EAAML,QAAS,WADpCC,CAAA,uBAIM,WAJN,cAKe,gBALf,KAMQ,WANR,YAQe,SARf,eAOkB3B,KAAK6B,aAPvB,kBAUgB,SAVhB,YAU8B,eAjCzC,8CAsC6B7B,KAAKD,QAtClC,KAsCgD,WAtChD,UAsCoEC,KAAK6B,aAtCzE,8BA2CiB,QA3CjB,iCAtDJ,GAAoB,QAelB,QADC,kB,yBAoCA,MAlDGpC,EAAK,QAZV,eAAU,CACTuC,WAAY,CACV,gBACA,cAAe,OAAKC,KACpB,kBACA,iBACA,iBAEFC,MAAO,CACLjC,KAAI,WAGFR,GA0GS,oBAAK0C,OAAO,GAAZ,CAAgB1C,I","file":"js/chunk-19aff9a4.c0112d68.js","sourcesContent":["import { Component, Emit, Vue } from 'vue-property-decorator';\r\nimport { Form, Button, Input, Icon } from 'ant-design-vue';\r\nimport config from '@/utils/config';\r\n\r\nimport './login.less';\r\n\r\n@Component({\r\n  components: {\r\n    'a-form': Form,\r\n    'a-form-item': Form.Item,\r\n    'a-button': Button,\r\n    'a-input': Input,\r\n    'a-icon': Icon,\r\n  },\r\n  props: {\r\n    Form,\r\n  },\r\n})\r\nclass Login extends Vue {\r\n  loginForm: {\r\n    username: string;\r\n    password: string;\r\n  } = { username: 'admin', password: 'admin' };\r\n\r\n  config = config;\r\n\r\n  imgToken = '';\r\n\r\n  loading = false;\r\n\r\n  created() {}\r\n\r\n  @Emit()\r\n  submitForm() {\r\n    this.Form.validateFields((err: any, values: object) => {\r\n      if (!err) {\r\n        this.loading = true;\r\n        window.api\r\n          .login({ ...values })\r\n          .then(res => {\r\n            this.loading = false;\r\n            const { resultCode, resultMessage, data } = res.data;\r\n            if (resultCode !== 0) {\r\n              this.$message.error(resultMessage || '未知错误');\r\n            } else {\r\n              this.$message.success(resultMessage);\r\n              //将token 保存在本地\r\n              localStorage.setItem('token', data.token);\r\n              setTimeout(() => {\r\n                this.$store\r\n                  .dispatch('getUserInfo')\r\n                  .then(() => {\r\n                    this.$router.push('/');\r\n                  })\r\n                  .catch(error => {\r\n                    this.$message.error(error);\r\n                  });\r\n              }, 200);\r\n            }\r\n          })\r\n          .catch((errs: any) => {\r\n            this.loading = false;\r\n            this.$message.error(errs.message);\r\n          });\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { getFieldDecorator } = this.Form;\r\n    return (\r\n      <div class='loginWrap'>\r\n        <h2 class='loginTxt'>\r\n          欢迎使用\r\n          <br />\r\n          品贤画室管理平台\r\n        </h2>\r\n        <div class='loginForm'>\r\n          <div class='logo'>\r\n            {/* <img alt='logo' src={require('../../assets/logo.png')} /> */}\r\n            <span>{config.name}</span>\r\n          </div>\r\n          <a-form ref='loginForm' on-submit={this.submitForm}>\r\n            <a-form-item>\r\n              {getFieldDecorator('username', {\r\n                rules: [{ required: true, message: '请输入用户名字' }],\r\n              })(\r\n                <a-input id='username' prefix-icon='iconfont-user' placeholder='请输入用户名字'>\r\n                  <a-icon slot='prefix' type='user' />\r\n                </a-input>,\r\n              )}\r\n            </a-form-item>\r\n            <a-form-item>\r\n              {getFieldDecorator('password', {\r\n                rules: [{ required: true, message: '请输入密码' }],\r\n              })(\r\n                <a-input\r\n                  id='password'\r\n                  prefix-icon='iconfont-lock'\r\n                  type='password'\r\n                  on-pressEnter={this.submitForm}\r\n                  placeholder='请输入密码'\r\n                >\r\n                  <a-icon slot='prefix' type='lock' />\r\n                </a-input>,\r\n              )}\r\n            </a-form-item>\r\n            <a-form-item>\r\n              <a-button loading={this.loading} type='primary' on-click={this.submitForm}>\r\n                Login\r\n              </a-button>\r\n            </a-form-item>\r\n          </a-form>\r\n          <div class='tips'>\r\n            <span>请妥善保管密码</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Form.create({})(Login);\r\n"],"sourceRoot":""}